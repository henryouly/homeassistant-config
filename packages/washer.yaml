switch:
  - platform: edimax
    host: 192.168.30.245
    name: washer_outlet

sensor:
  - platform: template
    sensors:
      washer_power:
        value_template: '{{ states.switch.washer_outlet.attributes["current_power_w"] | float * 1000000 | round(2) }}'
        unit_of_measurement: 'W'

binary_sensor:
  - platform: template
    sensors:
      washer_mode:
        value_template: '{{ states.sensor.washer_power.state | int > 10 }}'

input_boolean:
  laundry_done:
    name: Laundry notification

alert:
  laundry_done:
    name: Laundry is done
    done_message: Laundry is retrieved
    entity_id: input_boolean.laundry_done
    state: 'on'
    repeat: 10
    can_acknowledge: True
    skip_first: False
    notifiers:
      - yingying_phone

automation:
  - alias: Laundary is done
    trigger:
      - platform: state
        entity_id: binary_sensor.washer_mode
        to: "off"
        for: "00:03:00"
    action:
      - service: input_boolean.turn_on
        entity_id: input_boolean.laundry_done
