#############################################
# Project the stream to Kodi when we are home 
# action:
#   service: script.project_stream_to_kodi
#   data_template:
#     media_content_id: "rstp://..."
#############################################

project_stream_to_kodi:
  sequence:
    - condition: and
      conditions:
        - condition: state
          entity_id: group.all_devices
          state: 'home'
        - condition: state
          entity_id: input_boolean.speech_notification
          state: 'on'
        - condition: time
          after: '09:00:00'
          before: '22:00:00'
        - condition: template
          value_template: >
            {% if is_state('media_player.kodi', 'playing') %}
              false
            {% else %}
              true
            {% endif %}
    - service: media_player.turn_on
      entity_id: media_player.kodi
    - service: media_player.play_media
      data:
        entity_id: media_player.kodi
        media_content_id: '{{ media_content_id }}'
        media_content_type: VIDEO
